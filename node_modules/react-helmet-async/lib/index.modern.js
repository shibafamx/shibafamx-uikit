import e,{Component as t}from"react";import r from"prop-types";import n from"react-fast-compare";import s from"invariant";import o from"shallowequal";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e,t){if(null==e)return{};var r,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])>=0||(s[r]=e[r]);return s}const l={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title",FRAGMENT:"Symbol(react.fragment)"},c={rel:["amphtml","canonical","alternate"]},p={type:["application/ld+json"]},d={charset:"",name:["robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},h=Object.keys(l).map(e=>l[e]),u={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},m=Object.keys(u).reduce((e,t)=>(e[u[t]]=t,e),{}),T=(e,t)=>{for(let r=e.length-1;r>=0;r-=1){const n=e[r];if(Object.prototype.hasOwnProperty.call(n,t))return n[t]}return null},y=e=>{let t=T(e,l.TITLE);const r=T(e,"titleTemplate");if(Array.isArray(t)&&(t=t.join("")),r&&t)return r.replace(/%s/g,()=>t);const n=T(e,"defaultTitle");return t||n||void 0},g=e=>T(e,"onChangeClientState")||(()=>{}),f=(e,t)=>t.filter(t=>void 0!==t[e]).map(t=>t[e]).reduce((e,t)=>i({},e,t),{}),b=(e,t)=>t.filter(e=>void 0!==e[l.BASE]).map(e=>e[l.BASE]).reverse().reduce((t,r)=>{if(!t.length){const n=Object.keys(r);for(let s=0;s<n.length;s+=1){const o=n[s].toLowerCase();if(-1!==e.indexOf(o)&&r[o])return t.concat(r)}}return t},[]),A=(e,t,r)=>{const n={};return r.filter(t=>{return!!Array.isArray(t[e])||(void 0!==t[e]&&(r=`Helmet: ${e} should be of type "Array". Instead found type "${typeof t[e]}"`,console&&"function"==typeof console.warn&&console.warn(r)),!1);var r}).map(t=>t[e]).reverse().reduce((e,r)=>{const s={};r.filter(e=>{let r;const o=Object.keys(e);for(let n=0;n<o.length;n+=1){const s=o[n],i=s.toLowerCase();-1===t.indexOf(i)||"rel"===r&&"canonical"===e[r].toLowerCase()||"rel"===i&&"stylesheet"===e[i].toLowerCase()||(r=i),-1===t.indexOf(s)||"innerHTML"!==s&&"cssText"!==s&&"itemprop"!==s||(r=s)}if(!r||!e[r])return!1;const i=e[r].toLowerCase();return n[r]||(n[r]={}),s[r]||(s[r]={}),!n[r][i]&&(s[r][i]=!0,!0)}).reverse().forEach(t=>e.push(t));const o=Object.keys(s);for(let e=0;e<o.length;e+=1){const t=o[e],r=i({},n[t],s[t]);n[t]=r}return e},[]).reverse()},C=(e,t)=>{if(Array.isArray(e)&&e.length)for(let r=0;r<e.length;r+=1)if(e[r][t])return!0;return!1},S=e=>Array.isArray(e)?e.join(""):e,O=(e,t)=>Array.isArray(e)?e.reduce((e,r)=>(((e,t)=>{const r=Object.keys(e);for(let n=0;n<r.length;n+=1)if(t[r[n]]&&t[r[n]].includes(e[r[n]]))return!0;return!1})(r,t)?e.priority.push(r):e.default.push(r),e),{priority:[],default:[]}):{default:e},E=[l.NOSCRIPT,l.SCRIPT,l.STYLE],I=(e,t=!0)=>!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),x=e=>Object.keys(e).reduce((t,r)=>{const n=void 0!==e[r]?`${r}="${e[r]}"`:`${r}`;return t?`${t} ${n}`:n},""),P=(e,t={})=>Object.keys(e).reduce((t,r)=>(t[u[r]||r]=e[r],t),t),L=(t,r)=>r.map((r,n)=>{const s={key:n,"data-rh":!0};return Object.keys(r).forEach(e=>{const t=u[e]||e;"innerHTML"===t||"cssText"===t?s.dangerouslySetInnerHTML={__html:r.innerHTML||r.cssText}:s[t]=r[e]}),e.createElement(t,s)}),w=(t,r,n)=>{switch(t){case l.TITLE:return{toComponent:()=>((t,r,n)=>{const s=P(n,{key:r,"data-rh":!0});return[e.createElement(l.TITLE,s,r)]})(0,r.title,r.titleAttributes),toString:()=>((e,t,r,n)=>{const s=x(r),o=S(t);return s?`<${e} data-rh="true" ${s}>${I(o,n)}</${e}>`:`<${e} data-rh="true">${I(o,n)}</${e}>`})(t,r.title,r.titleAttributes,n)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>P(r),toString:()=>x(r)};default:return{toComponent:()=>L(t,r),toString:()=>((e,t,r)=>t.reduce((t,n)=>{const s=Object.keys(n).filter(e=>!("innerHTML"===e||"cssText"===e)).reduce((e,t)=>{const s=void 0===n[t]?t:`${t}="${I(n[t],r)}"`;return e?`${e} ${s}`:s},""),o=n.innerHTML||n.cssText||"",i=-1===E.indexOf(e);return`${t}<${e} data-rh="true" ${s}${i?"/>":`>${o}</${e}>`}`},""))(t,r,n)}}},j=e=>{const{baseTag:t,bodyAttributes:r,encode:n,htmlAttributes:s,noscriptTags:o,styleTags:i,title:a="",titleAttributes:h,prioritizeSeoTags:u}=e;let{linkTags:m,metaTags:T,scriptTags:y}=e,g={toComponent:()=>{},toString:()=>""};return u&&({priorityMethods:g,linkTags:m,metaTags:T,scriptTags:y}=(({metaTags:e,linkTags:t,scriptTags:r,encode:n})=>{const s=O(e,d),o=O(t,c),i=O(r,p);return{priorityMethods:{toComponent:()=>[...L(l.META,s.priority),...L(l.LINK,o.priority),...L(l.SCRIPT,i.priority)],toString:()=>`${w(l.META,s.priority,n)} ${w(l.LINK,o.priority,n)} ${w(l.SCRIPT,i.priority,n)}`},metaTags:s.default,linkTags:o.default,scriptTags:i.default}})(e)),{priority:g,base:w(l.BASE,t,n),bodyAttributes:w("bodyAttributes",r,n),htmlAttributes:w("htmlAttributes",s,n),link:w(l.LINK,m,n),meta:w(l.META,T,n),noscript:w(l.NOSCRIPT,o,n),script:w(l.SCRIPT,y,n),style:w(l.STYLE,i,n),title:w(l.TITLE,{title:a,titleAttributes:h},n)}};class v{constructor(e){this.instances=[],this.value={setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.instances,add:e=>{this.instances.push(e)},remove:e=>{const t=this.instances.indexOf(e);this.instances.splice(t,1)}}},this.context=e,v.canUseDOM||(e.helmet=j({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}}const $=e.createContext({}),k=r.shape({setHelmet:r.func,helmetInstances:r.shape({get:r.func,add:r.func,remove:r.func})}),M="undefined"!=typeof document;class H extends t{constructor(e){super(e),this.helmetData=new v(this.props.context)}render(){return e.createElement($.Provider,{value:this.helmetData.value},this.props.children)}}H.canUseDOM=M,H.propTypes={context:r.shape({helmet:r.shape()}),children:r.node.isRequired},H.defaultProps={context:{}},H.displayName="HelmetProvider";const N=(e,t)=>{const r=document.head||document.querySelector(l.HEAD),n=r.querySelectorAll(`${e}[data-rh]`),s=[].slice.call(n),o=[];let i;return t&&t.length&&t.forEach(t=>{const r=document.createElement(e);for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&("innerHTML"===e?r.innerHTML=t.innerHTML:"cssText"===e?r.styleSheet?r.styleSheet.cssText=t.cssText:r.appendChild(document.createTextNode(t.cssText)):r.setAttribute(e,void 0===t[e]?"":t[e]));r.setAttribute("data-rh","true"),s.some((e,t)=>(i=t,r.isEqualNode(e)))?s.splice(i,1):o.push(r)}),s.forEach(e=>e.parentNode.removeChild(e)),o.forEach(e=>r.appendChild(e)),{oldTags:s,newTags:o}},R=(e,t)=>{const r=document.getElementsByTagName(e)[0];if(!r)return;const n=r.getAttribute("data-rh"),s=n?n.split(","):[],o=[].concat(s),i=Object.keys(t);for(let e=0;e<i.length;e+=1){const n=i[e],a=t[n]||"";r.getAttribute(n)!==a&&r.setAttribute(n,a),-1===s.indexOf(n)&&s.push(n);const l=o.indexOf(n);-1!==l&&o.splice(l,1)}for(let e=o.length-1;e>=0;e-=1)r.removeAttribute(o[e]);s.length===o.length?r.removeAttribute("data-rh"):r.getAttribute("data-rh")!==i.join(",")&&r.setAttribute("data-rh",i.join(","))},D=(e,t)=>{const{baseTag:r,bodyAttributes:n,htmlAttributes:s,linkTags:o,metaTags:i,noscriptTags:a,onChangeClientState:c,scriptTags:p,styleTags:d,title:h,titleAttributes:u}=e;R(l.BODY,n),R(l.HTML,s),((e,t)=>{void 0!==e&&document.title!==e&&(document.title=S(e)),R(l.TITLE,t)})(h,u);const m={baseTag:N(l.BASE,r),linkTags:N(l.LINK,o),metaTags:N(l.META,i),noscriptTags:N(l.NOSCRIPT,a),scriptTags:N(l.SCRIPT,p),styleTags:N(l.STYLE,d)},T={},y={};Object.keys(m).forEach(e=>{const{newTags:t,oldTags:r}=m[e];t.length&&(T[e]=t),r.length&&(y[e]=m[e].oldTags)}),t&&t(),c(e,T,y)};let q=null;class Y extends t{constructor(...e){super(...e),this.rendered=!1}shouldComponentUpdate(e){return!o(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let r=null;const n=(s=e.get().map(e=>{const t=i({},e.props);return delete t.context,t}),{baseTag:b(["href"],s),bodyAttributes:f("bodyAttributes",s),defer:T(s,"defer"),encode:T(s,"encodeSpecialCharacters"),htmlAttributes:f("htmlAttributes",s),linkTags:A(l.LINK,["rel","href"],s),metaTags:A(l.META,["name","charset","http-equiv","property","itemprop"],s),noscriptTags:A(l.NOSCRIPT,["innerHTML"],s),onChangeClientState:g(s),scriptTags:A(l.SCRIPT,["src","innerHTML"],s),styleTags:A(l.STYLE,["cssText"],s),title:y(s),titleAttributes:f("titleAttributes",s),prioritizeSeoTags:C(s,"prioritizeSeoTags")});var s,o;H.canUseDOM?(o=n,q&&cancelAnimationFrame(q),o.defer?q=requestAnimationFrame(()=>{D(o,()=>{q=null})}):(D(o),q=null)):j&&(r=j(n)),t(r)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}}Y.propTypes={context:k.isRequired},Y.displayName="HelmetDispatcher";const B=["children"],K=["children","helmetData"];class U extends t{shouldComponentUpdate(e){return!n(this.props,e)}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case l.SCRIPT:case l.NOSCRIPT:return{innerHTML:t};case l.STYLE:return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren({child:e,arrayTypeChildren:t,newChildProps:r,nestedChildren:n}){return i({},t,{[e.type]:[...t[e.type]||[],i({},r,this.mapNestedChildrenToProps(e,n))]})}mapObjectTypeChildren({child:e,newProps:t,newChildProps:r,nestedChildren:n}){switch(e.type){case l.TITLE:return i({},t,{[e.type]:n,titleAttributes:i({},r)});case l.BODY:return i({},t,{bodyAttributes:i({},r)});case l.HTML:return i({},t,{htmlAttributes:i({},r)});default:return i({},t,{[e.type]:i({},r)})}}mapArrayTypeChildrenToProps(e,t){let r=i({},t);return Object.keys(e).forEach(t=>{r=i({},r,{[t]:e[t]})}),r}warnOnInvalidChildren(e,t){return s(h.some(t=>e.type===t),"function"==typeof e.type?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${h.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),s(!t||"string"==typeof t||Array.isArray(t)&&!t.some(e=>"string"!=typeof e),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(t,r){let n={};return e.Children.forEach(t,e=>{if(!e||!e.props)return;const t=e.props,{children:s}=t,o=a(t,B),i=Object.keys(o).reduce((e,t)=>(e[m[t]||t]=o[t],e),{});let{type:c}=e;switch("symbol"==typeof c?c=c.toString():this.warnOnInvalidChildren(e,s),c){case l.FRAGMENT:r=this.mapChildrenToProps(s,r);break;case l.LINK:case l.META:case l.NOSCRIPT:case l.SCRIPT:case l.STYLE:n=this.flattenArrayTypeChildren({child:e,arrayTypeChildren:n,newChildProps:i,nestedChildren:s});break;default:r=this.mapObjectTypeChildren({child:e,newProps:r,newChildProps:i,nestedChildren:s})}}),this.mapArrayTypeChildrenToProps(n,r)}render(){const t=this.props,{children:r,helmetData:n}=t;let s=i({},a(t,K));return r&&(s=this.mapChildrenToProps(r,s)),n?e.createElement(Y,i({},s,{context:n.value})):e.createElement($.Consumer,null,t=>e.createElement(Y,i({},s,{context:t})))}}U.propTypes={base:r.object,bodyAttributes:r.object,children:r.oneOfType([r.arrayOf(r.node),r.node]),defaultTitle:r.string,defer:r.bool,encodeSpecialCharacters:r.bool,htmlAttributes:r.object,link:r.arrayOf(r.object),meta:r.arrayOf(r.object),noscript:r.arrayOf(r.object),onChangeClientState:r.func,script:r.arrayOf(r.object),style:r.arrayOf(r.object),title:r.string,titleAttributes:r.object,titleTemplate:r.string,prioritizeSeoTags:r.bool,helmetData:r.object},U.defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1},U.displayName="Helmet";export{U as Helmet,v as HelmetData,H as HelmetProvider};
//# sourceMappingURL=index.modern.js.map
